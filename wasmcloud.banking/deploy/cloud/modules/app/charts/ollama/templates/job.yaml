
---
apiVersion: batch/v1
kind: Job
metadata:
  name: {{ .Release.Name }}-preseed-models
  namespace: {{ .Release.Namespace }}
spec:
  backoffLimit: 3
  activeDeadlineSeconds: 45
  template:
    spec:
      initContainers:
        - name: wait-for-ollama
          image: chainguard/wait-for-it:latest
          args:
            - ollama:11434
            - --timeout=15
            - --strict
      containers:
      - name: seed-llava-model
        image: chainguard/curl:latest
        args:
          - ollama:11434/api/pull
          - -d
          - '{"name": "llava"}'
      restartPolicy: OnFailure